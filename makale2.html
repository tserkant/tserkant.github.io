<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Parent Process PID Spoofing • Siber Güvenlik Blogu</title>
  <meta name="description" content="Parent Process PID Spoofing saldırısı, tespiti ve simülasyonu." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b1220;
      --surface: #0f172a;
      --card: #111a2e;
      --muted: #94a3b8;
      --text: #e6eefc;
      --title: #e8f0ff;
      --accent: #3b82f6;
      --accent-600: #2563eb;
      --accent-700: #1d4ed8;
      --ring: rgba(59,130,246,0.35);
      --border: #1e293b;
      --code-bg: #0b1430;
      --code-border: #1b2b52;
      --kbd-bg: #0f1b36;
      --kbd-border: #1c325f;
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 70% -10%, rgba(37,99,235,0.15), transparent),
                  radial-gradient(900px 600px at -10% 20%, rgba(59,130,246,0.12), transparent),
                  var(--bg);
      color: var(--text);
      line-height: 1.7;
    }

    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }

    .container { max-width: 1100px; margin: 0 auto; padding: 24px; }

    header { position: sticky; top: 0; z-index: 50; background: linear-gradient(180deg, rgba(8,13,26,0.9), rgba(8,13,26,0.7)); backdrop-filter: saturate(1.2) blur(8px); border-bottom: 1px solid var(--border); }
    .nav { display: flex; align-items: center; justify-content: space-between; gap: 16px; padding: 14px 24px; }
    .brand { display: flex; align-items: center; gap: 12px; font-weight: 700; letter-spacing: 0.2px; }
    .badge { width: 28px; height: 28px; display: grid; place-items: center; border-radius: 8px; background: linear-gradient(160deg, var(--accent), var(--accent-700)); box-shadow: inset 0 0 0 1px rgba(255,255,255,0.06); color: white; font-weight: 700; font-size: 14px; }
    .nav a.btn { display: inline-flex; align-items: center; gap: 8px; font-weight: 600; padding: 10px 14px; border: 1px solid var(--border); border-radius: 12px; background: #0b1325; }
    .nav a.btn:hover { border-color: var(--accent); box-shadow: 0 0 0 4px var(--ring); text-decoration: none; }

    .hero { padding: 28px 24px 8px; border-bottom: 1px dashed var(--border); }
    .breadcrumbs { color: var(--muted); font-size: 13px; letter-spacing: 0.2px; }
    .breadcrumbs a { color: var(--muted); }
    h1.title { margin: 12px 0 8px; font-size: 36px; line-height: 1.2; color: var(--title); }
    .meta { display: flex; flex-wrap: wrap; gap: 10px 16px; color: var(--muted); font-size: 14px; }
    .meta .dot { width: 4px; height: 4px; background: var(--border); border-radius: 999px; align-self: center; }

    .grid { display: grid; grid-template-columns: 1fr; gap: 24px; margin-top: 24px; }
    @media (min-width: 960px) { .grid { grid-template-columns: 1fr 300px; } aside.sticky { position: sticky; top: 88px; height: max-content; } }

    article { background: linear-gradient(180deg, rgba(37,99,235,0.06), transparent 120px), var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 28px; box-shadow: 0 10px 30px rgba(0,0,0,0.25); }
    article h2 { margin: 28px 0 10px; font-size: 24px; line-height: 1.3; }
    article h3 { margin: 20px 0 10px; font-size: 18px; line-height: 1.35; }
    article p { margin: 12px 0; }
    article ul, article ol { margin: 12px 0 12px 20px; }
    article li { margin: 6px 0; }
    blockquote { margin: 18px 0; padding: 14px 16px; border-left: 3px solid var(--accent); background: #0b1428; color: #cfe0ff; border-radius: 8px; }
    .note { border: 1px solid var(--border); background: #0b1325; border-radius: 12px; padding: 14px 16px; }
    pre, code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    pre { background: var(--code-bg); border: 1px solid var(--code-border); padding: 16px; border-radius: 12px; overflow: auto; font-size: 14px; line-height: 1.6; }
    code { background: rgba(59,130,246,0.12); padding: 2px 6px; border-radius: 6px; border: 1px solid rgba(59,130,246,0.25); }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 16px; }
  </style>
</head>
<body>
  <header>
    <div class="nav container">
      <div class="brand">
        <div class="badge">SK</div>
        <div>Siber Güvenlik Blogu</div>
      </div>
      <nav style="display:flex; gap:10px; align-items:center;">
        <a class="btn" href="index.html">Anasayfa</a>
        <a class="btn" href="https://www.linkedin.com/pulse/parent-process-pid-spoofing-nedir-nas%C4%B1l-%C3%A7al%C4%B1%C5%9F%C4%B1r-g%C3%BCvenlik-kocaa%C4%9Fa-5qoef/?trackingId=1xolB9eXrmyWGUg91GCZwA%3D%3D">Linkedin Üzerinden Oku</a>
        
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="breadcrumbs">
        <a href="#">Anasayfa</a> / <a href="#">Makaleler</a> / <span>Parent Process PID Spoofing</span>
      </div>
      <h1 class="title">Parent Process PID Spoofing Nedir? Nasıl Çalışır? Güvenlik Açısından Önemi</h1>
      <div class="meta">
        <div>Yazan: <strong>Serkan K.</strong></div>
        <div class="dot"></div>
        <div>Yayın: 16 Ağustos 2025</div>
        <div class="dot"></div>
        <div>Okuma: ~3 dk</div>
        <div class="dot"></div>
        <div>Kategori: <a href="#">Makale</a></div>
      </div>
    </section>

    <section class="grid">
      <article>
        <div class="note" role="note">
          Bu yazı, <strong>Parent Process PID Spoofing</strong> saldırısının temeli, simülasyonu, uygulama yöntemleri ve tespiti hakkında kapsamlı bilgiler içerir.
        </div>

        <h2>İşlem Hiyerarşisi ve Önemi</h2>
        <p>Windows işletim sistemlerinde her yeni başlatılan işlem (child process), başka bir işlem (parent process) tarafından tetiklenir. Örneğin, masaüstü ortamında açılan uygulamalar genellikle <code>explorer.exe</code> tarafından başlatılır. Bu hiyerarşi, EDR çözümleri ve log analiz platformları tarafından anomali tespiti için kullanılır.</p>

        <h2>Parent Process PID Spoofing Tekniği</h2>
        <p>Bu saldırı tekniği, kötü amaçlı bir işlemin güvenilir bir sistem sürecinin altında çalışıyor gibi görünmesini sağlar. Sistem ve analist gözünde güven verici bir parent process ile görünürlük kazanan zararlı yazılım, tespit edilme olasılığını azaltır.</p>
        <h3>Teknik Adımlar</h3>
        <ol>
          <li>STARTUPINFOEX yapısı hazırlanır.</li>
          <li>InitializeProcThreadAttributeList fonksiyonu ile attribute listesi oluşturulur.</li>
          <li>UpdateProcThreadAttribute fonksiyonu ile <code>PROC_THREAD_ATTRIBUTE_PARENT_PROCESS</code> parametresi eklenir.</li>
          <li>CreateProcess fonksiyonu, manipüle edilmiş yapı ile çağrılır ve child process sahte parent altında başlatılır.</li>
        </ol>

        <h3>Uygulama Alanları</h3>
        <p>C++ veya C# gibi sistem seviyesinde çalışan dillerle doğrudan Windows API’sine erişilerek gerçekleştirilebilir. PowerShell üzerinde doğrudan mümkün olmasa da, .NET ve P/Invoke kullanılarak CreateProcess erişimi ile yapılabilir.</p>

        <h2>Simülasyon ve Örnek Senaryo</h2>
        <p>Kendi sanal ortamımda (<code>marine.local</code>) kurduğum Active Directory üzerinde <strong>garp</strong> kullanıcı hesabı ile testler gerçekleştirildi. <code>dwm.exe</code> parent olarak seçildi ve <code>cmd.exe</code> başlatıldı:</p>
        <pre><code>ImpersonateFromParentPid -ppid 860 -command "C:\Windows\System32\cmd.exe" -cmdargs ""</code></pre>
        <p>Not: <code>dwm.exe</code> genellikle GUI odaklıdır ve normalde yeni işlemler başlatmaz. Bu nedenle anormal davranış tespitinde dikkat çeker. Standart senaryolarda <code>explorer.exe</code>, <code>cmd.exe</code> veya <code>powershell.exe</code> parent olarak seçilir.</p>

        <h2>Tespit Yöntemleri</h2>
        <p>Parent process spoofing’i ortaya çıkarmak için ETW tabanlı izleme araçları etkilidir:</p>
        <ul>
          <li><strong>Sysmon:</strong> Event ID 1 ile her process oluşumunu ve parent-child ilişkilerini kaydeder. Anormal ilişkiler, örn. <code>dwm.exe</code> altındaki <code>cmd.exe</code>, dikkat çeker.</li>
          <li><strong>SilkETW:</strong> Gerçek zamanlı event toplama ve süzme imkanı sağlar. Microsoft-Windows-Kernel-Process ve Sysmon provider’ları üzerinden loglar analiz edilerek sahte parent process’ler tespit edilir.</li>
        </ul>
        <pre><code>SilkETW.exe -t user -pn Microsoft-Windows-Kernel-Process -ot file -p C:\windows\temp\serkan.json</code></pre>

        <h2>Özet</h2>
        <p>Parent Process PID Spoofing, saldırganların güvenlik çözümlerini atlatmak için kullandığı gelişmiş bir tekniktir. İşlem hiyerarşisinin manipüle edilmesi, EDR ve davranış tabanlı sistemler tarafından dikkatlice analiz edilmelidir. Sysmon ve SilkETW gibi araçlar, bu tür anormalliklerin tespitinde kritik öneme sahiptir.</p>
      </article>

      <aside class="sticky card">
        <h3>İlgili Makaleler</h3>
        <ul>
          <li><a href="#yazilarim.html">Çok Yakında</a></li>
          
          
        </ul>
      </aside>
    </section>
  </main>
</body>
</html>
